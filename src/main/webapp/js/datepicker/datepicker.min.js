/*!! goa.foundation  -  2015-09-29 */
!function($){function escapeRegExp(a){return a.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")}function padLeft(a,b,c){return b<a.length?a:Array(b-a.length+1).join(c||" ")+a}function getTemplate(a,b,c,d,e,f,g){return b&&c?'<div class="bootstrap-datetimepicker-widget dropdown-menu 3" style="max-height:235px;"><div class="datepicker">'+DPGlobal.tempButton(a,g)+"</div></div>":c?'<div class="bootstrap-datetimepicker-widget dropdown-menu 2"><div class="timepicker">'+TPGlobal.getTemplate(d,e)+"</div></div>":'<div class="bootstrap-datetimepicker-widget dropdown-menu 1" style="max-height:215px;"><div class="datepicker">'+DPGlobal.tempButton(null,g)+"</div></div>"}function UTCDate(){return new Date(Date.UTC.apply(Date,arguments))}var smartPhone=void 0!=window.orientation,DateTimePicker=function(a,b){this.id=dpgId++,this.init(a,b)},dateToDate=function(a){return"string"==typeof a?new Date(a):a};DateTimePicker.prototype={constructor:DateTimePicker,init:function(a,b){if(!b.pickTime&&!b.pickDate)throw new Error("Must choose at least one picker");this.options=b,this.$element=$(a),this.$element.attr("readonly",!1),this.language="zh-CN",this.loadShow=b.loadShow,this.pickDate=b.pickDate,this.pickTime=b.pickTime,this.pickSeconds=b.pickSeconds;var c=this.$element.data("pick-date");void 0!=c&&(this.pickDate=c?!0:!1);var d=this.$element.data("pick-time");void 0!=d&&(this.pickTime=d?!0:!1);var e=this.$element.data("pick-second");void 0!=e&&(this.pickSeconds=e?!0:!1),this.isInput=this.$element.is("input"),this.component=!1,this.pickTime&&(this.timeIcon||(this.timeIcon="fa fa-clock")),this.pickDate&&(this.dateIcon||(this.dateIcon="fa fa-calendar2")),this.format=b.dateFormat,this.format||(this.format=this.isInput?this.$element.data("date-format"):this.$element.find("input").data("date-format"),this.format||(this.format="yyyy-MM-dd"));var f=this.loadShow=this.$element.hasClass("load-show")?1:0;if(f&&(this.pickTime=!1),this._compileFormat(),this.widget=$(getTemplate(this.timeIcon,this.pickDate,this.pickTime,b.pick12HourFormat,this.pickSeconds,b.collapse,f)).appendTo(f?this.$element:$("#scrollable")),this.inputStor={hours:this.widget.find("#dpTime input.tb"),minutes:this.widget.find("#dpTime input.te"),seconds:this.widget.find("#dpTime input.tl")},this.minViewMode=b.minViewMode||this.$element.data("date-minviewmode")||0,"string"==typeof this.minViewMode)switch(this.minViewMode){case"months":this.minViewMode=1;break;case"years":this.minViewMode=2;break;default:this.minViewMode=0}if(this.viewMode=b.viewMode||this.$element.data("date-viewmode")||0,"string"==typeof this.viewMode)switch(this.viewMode){case"months":this.viewMode=1;break;case"years":this.viewMode=2;break;default:this.viewMode=0}this.startViewMode=this.viewMode,this.weekStart=b.weekStart||this.$element.data("date-weekstart")||0,this.weekEnd=0===this.weekStart?6:this.weekStart-1,this.setStartDate(this.$element.data("start-date")||b.startDate),this.setEndDate(this.$element.data("end-date")||b.endDate),this.fillDow(),this.fillMonths(),this.update(),this.showMode(),this._attachDatePickerEvents()},show:function(a){var b=this.$element.data("ref-obj");if(b&&(tempString=b.split(" "),2==tempString.length&&(refObjId=tempString[0],operate=tempString[1],refObj=$(refObjId),refObj))){var c=refObj.val();c?(refObjDate=Date.parse(c.replace(/-/g,"/")),"lt"==operate&&this.setEndDate(new Date(refObjDate+864e5)),"gt"==operate&&this.setStartDate(new Date(refObjDate+288e5))):("lt"==operate&&"object"==typeof this.endDate&&this.setEndDate(1/0),"gt"==operate&&"object"==typeof this.startDate&&this.setStartDate(-(1/0)))}if(!this.$element.val()){var d=new Date;this._date=UTCDate(d.getFullYear(),d.getMonth(),d.getDate(),d.getHours(),d.getMinutes(),d.getSeconds(),d.getMilliseconds()),this.viewDate=this._date,this.fillDate()}this.pickDate&&this.pickTime&&(this.downMenuTime(),this.setTime(this._date.getUTCHours(),this._date.getUTCMinutes(),this._date.getUTCSeconds())),!this.pickDate&&this.pickTime&&this.pickSeconds&&this.fillTime(),this.widget.show(),this.height=this.component?this.component.outerHeight():this.$element.outerHeight(),this.loadShow||this.place(),this.$element.trigger({type:"show",date:this._date}),this._attachDatePickerGlobalEvents(),a&&(a.stopPropagation(),a.preventDefault())},disable:function(){this.$element.find("input").prop("disabled",!0),this._detachDatePickerEvents()},enable:function(){this.$element.find("input").prop("disabled",!1),this._attachDatePickerEvents()},hide:function(){if(this.widget.is(":visible")&&!this.loadShow){for(var a=this.widget.find(".collapse"),b=0;b<a.length;b++){var c=a.eq(b).data("collapse");if(c&&c.transitioning)return}var d=this.$element.val();if(""!=d&&null!=d){var e=this.parseDate(d);e||this.$element.val(confirm("不合法的日期格式或日期超出限定范围,需要撤销吗?")?"":"")}this.widget.hide(),this.viewMode=this.startViewMode,this.showMode(),this.$element.trigger({type:"hide",date:this._date}),this.$element.blur(),this._detachDatePickerGlobalEvents()}},set:function(){var a="";this._unset||(a=this.formatDate(this._date));var b=this.$element.data("ref-obj");if(b&&(tempString=b.split(" "),2==tempString.length&&(refObjId=tempString[0],operate=tempString[1],refObj=$(refObjId),refObj))){var c=refObj.val();if(c){if("lt"==operate&&a>c)return;if("gt"==operate&&c>a)return}}var d=new Date(Date.parse(a.replace(/-/g,"/"))+864e5);if(!(d.valueOf()>this.endDate.valueOf()||d.valueOf()<this.startDate.valueOf()))if(this.isInput)this.$element.val(a),this._resetMaskPos(this.$element);else{if(this.component){var e=this.$element.find("input");e.val(a),this._resetMaskPos(e)}this.$element.data("date",a)}},setValue:function(a){this._unset=a?!1:!0,"string"==typeof a?this._date=this.parseDate(a):a&&(this._date=new Date(a)),this.set(),this.viewDate=UTCDate(this._date.getUTCFullYear(),this._date.getUTCMonth(),1,0,0,0,0),this.fillDate(),this.fillTime()},setTime:function(a,b,c){for(var d=this.widget.find("input"),e=0;e<d.length;){switch(d[e].className){case"tb":this.inputStor.hours.val(padLeft(a.toString(),2,"0"));break;case"te":this.inputStor.minutes.val(padLeft(b.toString(),2,"0"));break;case"tl":this.inputStor.seconds.val(padLeft(c.toString(),2,"0"))}e++}},downMenuTime:function(){$("#dpTime .menuSel").hide()},getDate:function(){return this._unset?null:new Date(this._date.valueOf())},setDate:function(a){this.setValue(a?a.valueOf():null)},setStartDate:function(a){a instanceof Date?this.startDate=a:"string"==typeof a?a&&(this.startDate=new Date(Date.parse(a.replace(/-/g,"/"))+864e5),this.startDate.getUTCFullYear()||(this.startDate=-(1/0))):this.startDate=-(1/0),this.viewDate&&this.update()},setEndDate:function(a){a instanceof Date?this.endDate=a:"string"==typeof a?a&&(this.endDate=new Date(Date.parse(a.replace(/-/g,"/"))),this.endDate.getUTCFullYear()||(this.endDate=1/0)):this.endDate=1/0,this.viewDate&&this.update()},getLocalDate:function(){if(this._unset)return null;var a=this._date;return new Date(a.getUTCFullYear(),a.getUTCMonth(),a.getUTCDate(),a.getUTCHours(),a.getUTCMinutes(),a.getUTCSeconds(),a.getUTCMilliseconds())},setLocalDate:function(a){this.setValue(a?Date.UTC(a.getFullYear(),a.getMonth(),a.getDate(),a.getHours(),a.getMinutes(),a.getSeconds(),a.getMilliseconds()):null)},place:function(){var a="absolute",b=this.component?this.component.offset():this.$element.offset();this.width=this.component?this.component.outerWidth():this.$element.outerWidth(!0);var c=this.widget.outerHeight(!0),d=$("#scrollable"),e=this.component?this.component.offset():this.$element.offset();b.top=b.top+this.height+$("#scrollable").scrollTop(),void 0!=this.options.width&&this.widget.width(this.options.width),"left"==this.options.orientation&&(this.widget.addClass("left-oriented"),b.left=b.left-this.width+20),this._isInFixed()&&(a="fixed",b.top=e.top+this.height,b.left=b.left),d.width()<e.left+this.width?(b.right=d.width()-b.left-this.width+("fixed"==a?155:18),b.left="auto","fixed"==a?b.left=b.left-(this.width>120?this.height:105):""):b.right="auto",d.height()<e.top+c&&(b.top=b.top-this.height-c),this.widget.css({position:a,top:b.top,left:b.left,right:b.right}),this._modalPlace(this,b)},notifyChange:function(){this.$element.trigger({type:"changeDate",date:this.getDate(),localDate:this.getLocalDate()})},update:function(a){var b=a;if(!b&&(b=this.isInput?this.$element.val():this.$element.find("input").val(),b&&(this._date=this.parseDate(b)),!this._date)){var c=new Date;this._date=UTCDate(c.getFullYear(),c.getMonth(),c.getDate(),c.getHours(),c.getMinutes(),c.getSeconds(),c.getMilliseconds())}this.viewDate=UTCDate(this._date.getUTCFullYear(),this._date.getUTCMonth(),1,0,0,0,0),this.fillDate(),this.fillTime()},fillDow:function(){for(var a=this.weekStart,b=$("<tr>");a<this.weekStart+7;)b.append('<th class="dow">'+dates[this.language].daysMin[a++%7]+"</th>");this.widget.find(".datepicker-days thead").append(b)},fillMonths:function(){for(var a="",b=0;12>b;)a+='<span class="month">'+dates[this.language].monthsShort[b++]+"</span>";this.widget.find(".datepicker-months td").append(a)},fillDate:function(){var a=this.viewDate.getUTCFullYear(),b=this.viewDate.getUTCMonth(),c=UTCDate(this._date.getUTCFullYear(),this._date.getUTCMonth(),this._date.getUTCDate(),0,0,0,0),d="object"==typeof this.startDate?this.startDate.getUTCFullYear():-(1/0),e="object"==typeof this.startDate?this.startDate.getUTCMonth():-1,f="object"==typeof this.endDate?this.endDate.getUTCFullYear():1/0,g="object"==typeof this.endDate?this.endDate.getUTCMonth():12;this.widget.find(".datepicker-days").find(".disabled").removeClass("disabled"),this.widget.find(".datepicker-months").find(".disabled").removeClass("disabled"),this.widget.find(".datepicker-years").find(".disabled").removeClass("disabled"),this.widget.find(".datepicker-days th:eq(1)").text(a+"年 "+dates[this.language].months[b]);var h=UTCDate(a,b-1,28,0,0,0,0),i=DPGlobal.getDaysInMonth(h.getUTCFullYear(),h.getUTCMonth());h.setUTCDate(i),h.setUTCDate(i-(h.getUTCDay()-this.weekStart+7)%7),(a==d&&e>=b||d>a)&&this.widget.find(".datepicker-days th:eq(0)").addClass("disabled"),(a==f&&b>=g||a>f)&&this.widget.find(".datepicker-days th:eq(2)").addClass("disabled");var j=new Date(h.valueOf());j.setUTCDate(j.getUTCDate()+42),j=j.valueOf();for(var k,l,m=[];h.valueOf()<j;)h.getUTCDay()===this.weekStart&&(k=$("<tr>"),m.push(k)),l="",h.getUTCFullYear()<a||h.getUTCFullYear()==a&&h.getUTCMonth()<b?l+=" old":(h.getUTCFullYear()>a||h.getUTCFullYear()==a&&h.getUTCMonth()>b)&&(l+=" new"),h.valueOf()===c.valueOf()&&(l+=" active"),h.valueOf()+864e5<=this.startDate&&(l+=" disabled"),h.valueOf()>this.endDate&&(l+=" disabled"),k.append('<td class="day'+l+'">'+h.getUTCDate()+"</td>"),h.setUTCDate(h.getUTCDate()+1);this.widget.find(".datepicker-days tbody").empty().append(m);var n=this._date.getUTCFullYear(),o=this.widget.find(".datepicker-months").find("th:eq(1)").text(a+"年").end().find("span").removeClass("active");n===a&&o.eq(this._date.getUTCMonth()).addClass("active"),d>n-1&&this.widget.find(".datepicker-months th:eq(0)").addClass("disabled"),n+1>f&&this.widget.find(".datepicker-months th:eq(2)").addClass("disabled");for(var p=0;12>p;p++)a==d&&e>p||d>a?$(o[p]).addClass("disabled"):(a==f&&p>g||a>f)&&$(o[p]).addClass("disabled");m="",a=10*parseInt(a/10,10);var q=this.widget.find(".datepicker-years").find("th:eq(1)").text(a+"年 - "+(a+9)+"年").end().find("td");this.widget.find(".datepicker-years").find("th").removeClass("disabled"),d>a&&this.widget.find(".datepicker-years").find("th:eq(0)").addClass("disabled"),a+9>f&&this.widget.find(".datepicker-years").find("th:eq(2)").addClass("disabled"),a-=1;for(var p=-1;11>p;p++)m+='<span class="year'+(-1===p||10===p?" old":"")+(n===a?" active":"")+(d>a||a>f?" disabled":"")+'">'+a+"</span>",a+=1;q.html(m)},fillHours:function(){var a=this.widget.find(".timepicker .timepicker-hours table");a.parent().hide();var b="";if(this.options.pick12HourFormat)for(var c=1,d=0;3>d;d+=1){b+="<tr>";for(var e=0;4>e;e+=1){var f=c.toString();b+='<td class="hour">'+padLeft(f,2,"0")+"</td>",c++}b+="</tr>"}else for(var c=0,d=0;6>d;d+=1){b+="<tr>";for(var e=0;4>e;e+=1){var f=c.toString();b+='<td class="hour">'+padLeft(f,2,"0")+"</td>",c++}b+="</tr>"}a.html(b)},fillMinutes:function(){var a=this.widget.find(".timepicker .timepicker-minutes table");a.parent().hide();for(var b="",c=0,d=0;5>d;d++){b+="<tr>";for(var e=0;4>e;e+=1){var f=c.toString();b+='<td class="minute">'+padLeft(f,2,"0")+"</td>",c+=3}b+="</tr>"}a.html(b)},fillSeconds:function(){var a=this.widget.find(".timepicker .timepicker-seconds table");a.parent().hide();for(var b="",c=0,d=0;5>d;d++){b+="<tr>";for(var e=0;4>e;e+=1){var f=c.toString();b+='<td class="second">'+padLeft(f,2,"0")+"</td>",c+=3}b+="</tr>"}a.html(b)},fillTime:function(){if(this._date){var a=this.widget.find(".timepicker span[data-time-component]"),b=(a.closest("table"),this.options.pick12HourFormat),c=this._date.getUTCHours(),d=0,e=0,f="AM";b&&(c>=12&&(f="PM"),0===c?c=12:12!=c&&(c%=12),this.widget.find(".timepicker [data-action=togglePeriod]").text(f)),c=c.toString(),d=this._date.getUTCMinutes().toString(),e=this._date.getUTCSeconds().toString(),a.find("input").each(function(){switch($(this).data("action")){case"selectHour":$(this).val(padLeft(c,2,"0"));break;case"selectMinute":$(this).val(padLeft(d,2,"0"));break;case"selectSecond":$(this).val(padLeft(e,2,"0"))}})}},click:function(a){a.stopPropagation(),a.preventDefault(),this._unset=!1;var b=$(a.target).closest("span, td, th, button, i, input");if(1===b.length&&!b.is(".disabled"))switch(this.downMenuTime(),b[0].nodeName.toLowerCase()){case"th":switch(b[0].className){case"switch":this.showMode(1);break;case"prev":case"next":var c=this.viewDate,d=DPGlobal.modes[this.viewMode].navFnc,e=DPGlobal.modes[this.viewMode].navStep;"prev"===b[0].className&&(e=-1*e),c["set"+d](c["get"+d]()+e),this.fillDate(),this.set()}break;case"span":if(b.is(".menuSapn")){var f=parseInt(b.text(),10)||0;return b.parent().is(".hhMenu")&&this.inputStor.hours.val(padLeft(f.toString(),2,"0")),b.parent().is(".mmMenu")&&this.inputStor.minutes.val(padLeft(f.toString(),2,"0")),b.parent().is(".ssMenu")&&this.inputStor.seconds.val(padLeft(f.toString(),2,"0")),void this.downMenuTime()}if(b.is(".month")){var g=b.parent().find("span").index(b);this.viewDate.setUTCMonth(g)}else{var h=parseInt(b.text(),10)||0;this.viewDate.setUTCFullYear(h)}0!==this.viewMode&&(this._date=UTCDate(this.viewDate.getUTCFullYear(),this.viewDate.getUTCMonth(),this.viewDate.getUTCDate(),this._date.getUTCHours(),this._date.getUTCMinutes(),this._date.getUTCSeconds(),this._date.getUTCMilliseconds()),this.notifyChange()),this.showMode(-1),this.fillDate(),this.set(),2==this.viewMode&&2==this.minViewMode&&this.hide();break;case"td":if(b.is(".day")){var i=parseInt(b.text(),10)||1,g=this.viewDate.getUTCMonth(),h=this.viewDate.getUTCFullYear();b.is(".old")?0===g?(g=11,h-=1):g-=1:b.is(".new")&&(11==g?(g=0,h+=1):g+=1),this._date=UTCDate(h,g,i,this._date.getUTCHours(),this._date.getUTCMinutes(),this._date.getUTCSeconds(),this._date.getUTCMilliseconds()),this.viewDate=UTCDate(h,g,Math.min(28,i),0,0,0,0),this.onCallback(a),this.fillDate(),this.set(),this.notifyChange(),this.pickTime&&this.pickDate?b.is(".active")&&this.hide():this.hide()}break;case"button":switch(b[0].className){case"clear":this.$element.val("").removeClass("ferror"),this.hide();break;case"today":var j=new Date;this._date=this.pickDate&&this.pickTime?UTCDate(j.getFullYear(),j.getMonth(),j.getDate(),this.compareTime(this.inputStor.hours.val(),"hour"),this.compareTime(this.inputStor.minutes.val(),"minutes"),this.compareTime(this.inputStor.seconds.val(),"seconds"),this._date.getUTCMilliseconds()):UTCDate(j.getFullYear(),j.getMonth(),j.getDate(),j.getUTCHours(),j.getUTCMinutes(),j.getUTCSeconds(),j.getUTCMilliseconds()),this.fillDate(),this.set(),this.notifyChange(),this.hide(),this.onCallback(a);break;case"confirm":this.pickDate&&this.pickTime&&(this._date=UTCDate(this._date.getUTCFullYear(),this._date.getUTCMonth(),this._date.getUTCDate(),this.compareTime(this.inputStor.hours.val(),"hour"),this.compareTime(this.inputStor.minutes.val(),"minutes"),this.compareTime(this.inputStor.seconds.val(),"seconds"),this._date.getUTCMilliseconds())),this.set(),this.notifyChange(),this.hide(),this.onCallback(a)}break;case"i":break;case"input":switch(b[0].className){case"tb":$(b[0]).focus(),$(b[0]).blur(function(){var a=parseInt($(this).val(),10)||0;a>23&&(a=23),$(b[0]).val(padLeft(a.toString(),2,"0"))}),$("#dpTime .hhMenu").show().siblings(".menuSel").hide();break;case"te":$(b[0]).focus(),$(b[0]).blur(function(){var a=parseInt($(this).val(),10)||0;a>59&&(a=59),$(b[0]).val(padLeft(a.toString(),2,"0"))}),$("#dpTime .mmMenu").show().siblings(".menuSel").hide();break;case"tl":$(b[0]).focus(),$(b[0]).blur(function(){var a=parseInt($(this).val(),10)||0;a>59&&(a=59),$(b[0]).val(padLeft(a.toString(),2,"0"))}),$("#dpTime .ssMenu").show().siblings(".menuSel").hide()}}},onCallback:function(e){var functionName=this.$element.data("callback")||0;if(functionName){var functionObj=eval(functionName);"function"==typeof functionObj&&(e.pickerObject=this,functionObj.apply(this.$element,arguments))}},actions:{incrementHours:function(a){this.actions.blurTime.call(this),this._date.setUTCHours(this._date.getUTCHours()+1)},incrementMinutes:function(a){this.actions.blurTime.call(this),this._date.setUTCMinutes(this._date.getUTCMinutes()+1)},incrementSeconds:function(a){this.actions.blurTime.call(this),this._date.setUTCSeconds(this._date.getUTCSeconds()+1)},decrementHours:function(a){this.actions.blurTime.call(this),this._date.setUTCHours(this._date.getUTCHours()-1)},decrementMinutes:function(a){this.actions.blurTime.call(this),this._date.setUTCMinutes(this._date.getUTCMinutes()-1)},decrementSeconds:function(a){this.actions.blurTime.call(this),this._date.setUTCSeconds(this._date.getUTCSeconds()-1)},togglePeriod:function(a){var b=this._date.getUTCHours();b>=12?b-=12:b+=12,this._date.setUTCHours(b)},showPicker:function(){this.widget.find(".timepicker > div:not(.timepicker-picker)").hide(),this.widget.find(".timepicker .timepicker-picker").show()},showHours:function(){},sureTime:function(a){var b=this.widget.find(".timepicker span[data-time-component]"),c=this;b.find("input").each(function(){var a=$(this).val();switch($(this).data("action")){case"selectHour":c._date.setUTCHours(c.compareTime(a,"hour"));break;case"selectMinute":c._date.setUTCMinutes(c.compareTime(a,"minutes"));break;case"selectSecond":c._date.setUTCSeconds(c.compareTime(a,"seconds"))}}),c.hide(),this.onCallback(a)},clearTime:function(){this.$element.val(""),this.hide()},showMinutes:function(){},showSeconds:function(){},blurTime:function(){var a=this.widget.find(".timepicker span[data-time-component]"),b=this;a.find("input").each(function(){var a=$(this).val();switch($(this).data("action")){case"selectHour":b._date.setUTCHours(b.compareTime(a,"hour"));break;case"selectMinute":b._date.setUTCMinutes(b.compareTime(a,"minutes"));break;case"selectSecond":b._date.setUTCSeconds(b.compareTime(a,"seconds"))}})},selectHour:function(a){$(a.target).focus()},selectMinute:function(a){$(a.target).focus()},selectSecond:function(a){$(a.target).focus()}},doAction:function(a){a.stopPropagation(),a.preventDefault(),this._date||(this._date=UTCDate(1970,0,0,0,0,0,0));var b=$(a.currentTarget).data("action"),c=this.actions[b].apply(this,arguments);return"clearTime"==b||"selectHour"==b||"selectMinute"==b||"selectSecond"==b?c:(this.set(),this.fillTime(),this.notifyChange(),c)},setFillTime:function(a,b){""!==a&&("hour"==b?this._date.setUTCHours(this.compareTime(a,b)):"minute"==b?this._date.setUTCMinutes(this.compareTime(a,b)):"second"==b&&this._date.setUTCSeconds(this.compareTime(a,b)),this.set(),this.fillTime(),this.notifyChange())},stopEvent:function(a){a.stopPropagation(),a.preventDefault()},compareTime:function(a,b){var c=parseInt(a,10)||0;return"hour"==b?c>23&&(c=23):c>59&&(c=59),c},keydown:function(a){var b=a.keyCode||a.which;9==b&&this.hide()},keypress:function(a){var b=String.fromCharCode(a.keyCode).toLowerCase();if(!a.ctrlKey||"v"!=b){var c=a.which;if(8!=c&&46!=c){var d=$(a.target),e=String.fromCharCode(c),f=d.val()||"";f+=e;var g=this._mask[this._maskPos];if(!g)return!1;if(g.end==f.length){if(!g.pattern.test(f.slice(g.start))){for(f=f.slice(0,f.length-1);(g=this._mask[this._maskPos])&&g.character;)f+=g.character,this._maskPos++;return f+=e,g.end!=f.length?(d.val(f),!1):g.pattern.test(f.slice(g.start))?(d.val(f),this._maskPos++,!1):(d.val(f.slice(0,g.start)),!1)}this._maskPos++}}}},change:function(a){var b=$(a.target);this._resetMaskPos(b)},showMode:function(a){a&&(this.viewMode=Math.max(this.minViewMode,Math.min(2,this.viewMode+a))),this.widget.find(".datepicker > div").hide().filter(".datepicker-"+DPGlobal.modes[this.viewMode].clsName).show()},destroy:function(){this._detachDatePickerEvents(),this._detachDatePickerGlobalEvents(),this.widget.remove(),this.$element.removeData("datetimepicker"),this.component.removeData("datetimepicker")},formatDate:function(a){return this.format.replace(formatReplacer,function(b){var c,d,e,f=b.length;if("ms"===b&&(f=1),d=dateFormatComponents[b].property,"Hours12"===d)e=a.getUTCHours(),0===e?e=12:12!==e&&(e%=12);else{if("Period12"===d)return a.getUTCHours()>=12?"PM":"AM";"UTCYear"===d?(e=a.getUTCFullYear(),e=e.toString().substr(2)):(c="get"+d,e=a[c]())}return"getUTCMonth"===c&&(e+=1),padLeft(e.toString(),f,"0")})},parseDate:function(a){var b,c,d,e,f={};if(!(b=this._formatPattern.exec(a)))return null;for(c=1;c<b.length;c++)d=this._propertiesByIndex[c],d&&(e=b[c],/^\d+$/.test(e)&&(e=parseInt(e,10)),f[d]=e);return this._finishParsingDate(f)},_resetMaskPos:function(a){for(var b=a.val(),c=0;c<this._mask.length;c++){if(this._mask[c].end>b.length){this._maskPos=c;break}if(this._mask[c].end===b.length){this._maskPos=c+1;break}}},_finishParsingDate:function(a){var b,c,d,e,f,g,h;return b=a.UTCFullYear,a.UTCYear&&(b=2e3+a.UTCYear),b||(b=1970),c=a.UTCMonth?a.UTCMonth-1:0,d=a.UTCDate||1,e=a.UTCHours||0,f=a.UTCMinutes||0,g=a.UTCSeconds||0,h=a.UTCMilliseconds||0,a.Hours12&&(e=a.Hours12),a.Period12&&(/pm/i.test(a.Period12)?12!=e&&(e=(e+12)%24):e%=12),UTCDate(b,c,d,e,f,g,h)},_compileFormat:function(){for(var a,b,c=[],d=[],e=this.format,f={},g=0,h=0;a=formatComponent.exec(e);)b=a[0],b in dateFormatComponents?(g++,f[g]=dateFormatComponents[b].property,c.push("\\s*"+dateFormatComponents[b].getPattern(this)+"\\s*"),d.push({pattern:new RegExp(dateFormatComponents[b].getPattern(this)),property:dateFormatComponents[b].property,start:h,end:h+=b.length})):(c.push(escapeRegExp(b)),d.push({pattern:new RegExp(escapeRegExp(b)),character:b,start:h,end:++h})),e=e.slice(b.length);this._mask=d,this._maskPos=0,this._formatPattern=new RegExp("^\\s*"+c.join("")+"\\s*$"),this._propertiesByIndex=f},inputBlur:function(a){!this.widget.is(":visible")},_attachDatePickerEvents:function(){var a=this;this.widget.on("click",".datepicker *",$.proxy(this.click,this)),this.widget.on("click","[data-action]",$.proxy(this.doAction,this)),this.isInput&&this.$element.on("blur",$.proxy(this.inputBlur,this)),this.widget.on("mousedown",$.proxy(this.stopEvent,this)),this.pickDate&&this.pickTime&&this.widget.on("click.togglePicker",".accordion-toggle",function(b){b.stopPropagation();var c=$(this),d=c.closest("ul"),e=d.find(".collapse.in"),f=d.find(".collapse:not(.in)");if(e&&e.length){var g=e.data("collapse");if(g&&g.transitioning)return;e.collapse("hide"),f.collapse("show"),c.find("i").toggleClass(a.timeIcon+" "+a.dateIcon),a.$element.find(".add-on i").toggleClass(a.timeIcon+" "+a.dateIcon)}}),this.loadShow&&this.widget.show(),this.isInput?(this.$element.on({focus:$.proxy(this.show,this),keyup:$.proxy(this.change,this)}),this.options.maskInput&&this.$element.on({keydown:$.proxy(this.keydown,this),keypress:$.proxy(this.keypress,this)})):(this.$element.on({change:$.proxy(this.change,this)},"input"),this.options.maskInput&&this.$element.on({keydown:$.proxy(this.keydown,this),keypress:$.proxy(this.keypress,this)},"input"),this.component?this.component.on("click",$.proxy(this.show,this)):this.$element.on("click",$.proxy(this.show,this)))},_attachDatePickerGlobalEvents:function(){$(document).on("mousedown.datetimepicker"+this.id,$.proxy(this.hide,this))},_detachDatePickerEvents:function(){this.widget.off("click",".datepicker *",this.click),this.widget.off("click","[data-action]"),this.widget.off("mousedown",this.stopEvent),this.pickDate&&this.pickTime&&this.widget.off("click.togglePicker"),this.isInput?(this.$element.off("blur",this.inputBlur),this.$element.off({focus:this.show,change:this.change}),this.options.maskInput&&this.$element.off({keydown:this.keydown,keypress:this.keypress})):(this.$element.off({change:this.change},"input"),this.options.maskInput&&this.$element.off({keydown:this.keydown,keypress:this.keypress},"input"),this.component?this.component.off("click",this.show):this.$element.off("click",this.show))},_detachDatePickerGlobalEvents:function(){$(window).off("resize.datetimepicker"+this.id),$(document).off("mousedown.datetimepicker"+this.id)},_isInFixed:function(){if(this.$element){for(var a=this.$element.parents(),b=!1,c=0;c<a.length;c++)if("fixed"==$(a[c]).css("position")){b=!0;break}return b}return!1},_modalPlace:function(a,b){var c=a.$element.closest(".modal-body");c.scroll(function(){a.hide()})}},$.fn.datepicker=function(a,b){return this.each(function(){var c=$(this),d=c.data("datetimepicker"),e="object"==typeof a&&a;d||c.data("datetimepicker",d=new DateTimePicker(this,$.extend({},$.fn.datepicker.defaults,e))),"string"==typeof a&&d[a](b)})},$.fn.datepicker.defaults={maskInput:!0,pickDate:!0,pickTime:!1,pick12HourFormat:!1,pickSeconds:!0,startDate:-(1/0),endDate:1/0,collapse:!0,loadShow:!1},$.fn.datepicker.Constructor=DateTimePicker;var dpgId=0,dates=$.fn.datepicker.dates={"zh-CN":{days:["星期日","星期一","星期二","星期三","星期四","星期五","星期六","星期日"],daysShort:["周日","周一","周二","周三","周四","周五","周六","周日"],daysMin:["日","一","二","三","四","五","六","日"],months:["1月","2月","3月","4月","5月","6月","7月","8月","9月","10月","11月","12月"],monthsShort:["1月","2月","3月","4月","5月","6月","7月","8月","9月","10月","11月","12月"],today:"今日"}},dateFormatComponents={dd:{property:"UTCDate",getPattern:function(){return"(0?[1-9]|[1-2][0-9]|3[0-1])\\b"}},MM:{property:"UTCMonth",getPattern:function(){return"(0?[1-9]|1[0-2])\\b"}},yy:{property:"UTCYear",getPattern:function(){return"(\\d{2})\\b"}},yyyy:{property:"UTCFullYear",getPattern:function(){return"(\\d{4})\\b"}},hh:{property:"Hours12",getPattern:function(){return"(0?[1-9]|1[0-2])\\b"}},mm:{property:"UTCMinutes",getPattern:function(){return"(0?[0-9]|[1-5][0-9])\\b"}},ss:{property:"UTCSeconds",getPattern:function(){return"(0?[0-9]|[1-5][0-9])\\b"}},ms:{property:"UTCMilliseconds",getPattern:function(){return"([0-9]{1,3})\\b"}},HH:{property:"UTCHours",getPattern:function(){return"(0?[0-9]|1[0-9]|2[0-3])\\b"}},PP:{property:"Period12",getPattern:function(){return"(AM|PM|am|pm|Am|aM|Pm|pM)\\b"}}},keys=[];for(var k in dateFormatComponents)keys.push(k);keys[keys.length-1]+="\\b",keys.push(".");var formatComponent=new RegExp(keys.join("\\b|"));keys.pop();var formatReplacer=new RegExp(keys.join("\\b|"),"g"),DPGlobal={modes:[{clsName:"days",navFnc:"UTCMonth",navStep:1},{clsName:"months",navFnc:"UTCFullYear",navStep:1},{clsName:"years",navFnc:"UTCFullYear",navStep:10}],isLeapYear:function(a){return a%4===0&&a%100!==0||a%400===0},getDaysInMonth:function(a,b){return[31,DPGlobal.isLeapYear(a)?29:28,31,30,31,30,31,31,30,31,30,31][b]},headTemplate:'<thead><tr><th class="prev">&lsaquo;</th><th colspan="5" class="switch" ></th><th class="next">&rsaquo;</th></tr></thead>',contTemplate:'<tbody><tr><td colspan="7"></td></tr></tbody>'};DPGlobal.template='<div class="datepicker-days"><table class="table-condensed">'+DPGlobal.headTemplate+'<tbody></tbody></table></div><div class="datepicker-months"><table class="table-condensed">'+DPGlobal.headTemplate+DPGlobal.contTemplate+'</table></div><div class="datepicker-years"><table class="table-condensed">'+DPGlobal.headTemplate+DPGlobal.contTemplate+"</table></div>",DPGlobal.timeModelate='<div class="menuSel hhMenu" ><span class="menuSapn">0</span><span class="menuSapn">1</span><span class="menuSapn">2</span><span class="menuSapn">3</span><span class="menuSapn">4</span><span class="menuSapn">5</span><span class="menuSapn">6</span><span class="menuSapn">7</span><span class="menuSapn">8</span><span class="menuSapn">9</span><span class="menuSapn">10</span><span class="menuSapn">11</span><span class="menuSapn">12</span><span class="menuSapn">13</span><span class="menuSapn">14</span><span class="menuSapn">15</span><span class="menuSapn">16</span><span class="menuSapn">17</span><span class="menuSapn">18</span><span class="menuSapn">19</span><span class="menuSapn">20</span><span class="menuSapn">21</span><span class="menuSapn">22</span><span class="menuSapn">23</span></div><div class="menuSel mmMenu" ><span class="menuSapn">0</span><span class="menuSapn">5</span><span class="menuSapn">10</span><span class="menuSapn">15</span><span class="menuSapn">20</span><span class="menuSapn">25</span><span class="menuSapn">30</span><span class="menuSapn">35</span><span class="menuSapn">40</span><span class="menuSapn">45</span><span class="menuSapn">50</span><span class="menuSapn">55</span></div><div class="menuSel ssMenu" ><span class="menuSapn">0</span><span class="menuSapn">10</span><span class="menuSapn">20</span><span class="menuSapn">30</span><span class="menuSapn">40</span><span class="menuSapn">50</span></div>',DPGlobal.timeiInputMode='<div class="dpconter"><font class="bold m-r-sm">时间</font></div><div class="dpconter b"><input class="tb" maxlength="2"/><b class="tm">:</b><input class="te" maxlength="2"/><b class="tm">:</b><input class="tl" maxlength="2"/></div>',DPGlobal.tempButton=function(a,b){return null==a?'<div class="datepicker-days"><table class="table-condensed">'+DPGlobal.headTemplate+"<tbody></tbody></table>"+(b?"":'<div class="fr"><button class="clear">清空</button><button class="today" style="margin-left: 5px;">今天</button><button class="confirm" style="margin-left: 5px;">确定</button></div>')+'</div><div class="datepicker-months"><table class="table-condensed">'+DPGlobal.headTemplate+DPGlobal.contTemplate+'</table></div><div class="datepicker-years"><table class="table-condensed">'+DPGlobal.headTemplate+DPGlobal.contTemplate+"</table></div>":'<div class="datepicker-days"><table class="table-condensed">'+DPGlobal.headTemplate+'<tbody></tbody></table><div class="divconter" id="dpTime">'+DPGlobal.timeModelate+DPGlobal.timeiInputMode+"</div>"+(b?"":'<div class="fr"><button class="clear">清空</button><button class="today" style="margin-left: 5px;">今天</button><button class="confirm" style="margin-left: 5px;">确定</button></div>')+'</div><div class="datepicker-months"><table class="table-condensed">'+DPGlobal.headTemplate+DPGlobal.contTemplate+'</table></div><div class="datepicker-years"><table class="table-condensed">'+DPGlobal.headTemplate+DPGlobal.contTemplate+"</table></div>"};var TPGlobal={hourTemplate:'<span data-action="showHours" data-time-component="hours" class="timepicker-hour"><input type="text" maxlength="2" data-action="selectHour" style="text-align:center; vertical-align:middle"/></span>',minuteTemplate:'<span data-action="showMinutes" data-time-component="minutes" class="timepicker-minute"><input type="text" maxlength="2" data-action="selectMinute" style="text-align:center; vertical-align:middle"/></span>',secondTemplate:'<span data-action="showSeconds" data-time-component="seconds" class="timepicker-second"><input type="text" maxlength="2" data-action="selectSecond" style="text-align:center; vertical-align:middle"/></span>'};TPGlobal.getTemplate=function(a,b){return'<div class="timepicker-picker"><table class="table-condensed"'+(a?' data-hour-format="12"':"")+'><tr><td><a href="#" class="btn" data-action="incrementHours"><i class="fa fa-chevron-up"></i></a></td><td class="separator"></td><td><a href="#" class="btn" data-action="incrementMinutes"><i class="fa fa-chevron-up"></i></a></td>'+(b?'<td class="separator"></td><td><a href="#" class="btn" data-action="incrementSeconds"><i class="fa fa-chevron-up"></i></a></td>':"")+(a?'<td class="separator"></td>':"")+"</tr><tr><td>"+TPGlobal.hourTemplate+'</td> <td class="separator">:</td><td>'+TPGlobal.minuteTemplate+"</td> "+(b?'<td class="separator">:</td><td>'+TPGlobal.secondTemplate+"</td>":"")+(a?'<td class="separator"></td><td><button type="button" class="btn btn-primary" data-action="togglePeriod"></button></td>':"")+'</tr><tr><td><a href="#" class="btn" data-action="decrementHours"><i class="fa fa-chevron-down"></i></a></td><td class="separator"></td><td><a href="#" class="btn" data-action="decrementMinutes"><i class="fa fa-chevron-down"></i></a></td>'+(b?'<td class="separator"></td><td><a href="#" class="btn" data-action="decrementSeconds"><i class="fa fa-chevron-down"></i></a></td>':"")+(a?'<td class="separator"></td>':"")+'</tr></table><div class="fr m-t-xs"><button data-action="clearTime">清空</button><button data-action="sureTime" style="margin-left:10px;">确定</button></div></div>';

}}(window.jQuery);